function zeroPad(a,b){return b=b||2,b-=a.toString().length,b>0?new Array(b+(/\./.test(a)?2:1)).join("0")+a:a+""}function formatTime(a,b){return b=b||new Date,HH=b.getHours(),hh=HH,a=replaceAll(a,"{mm}",zeroPad(b.getMinutes(),2)),a=replaceAll(a,"{ss}",zeroPad(b.getSeconds(),2)),mr="am",hh>11?(mr="pm",hh>12&&(hh-=12)):0==hh&&(hh="12"),a=replaceAll(a,"{hh}",zeroPad(hh,2)),a=replaceAll(a,"{HH}",zeroPad(HH,2)),a=replaceAll(a,"{mr}",mr)}var tadpole={};tadpole.VERSION="0.0.2",tadpole.STATE="alpha",function(a){a.fn.tadpole=function(b,c,d){var e=a(window).data("tadpole");return("init"==b||void 0===e)&&(void 0==e&&(e=new tadpole.UI(a(this),c,d,a.browser.mozilla||!1),a(window).resize(function(){e.resize()}),setInterval(function(){e.loop()},12e4),e.build()),a(window).data("tadpole",e)),"init"!=b&&void 0!=b&&(b="jq_"+b,b in e&&e[b](a(this),d)),e}}(jQuery),replaceAll=function(a,b,c){return a.split(b).join(c)},Object.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},Object.steal=function(a,b){for(var c in b)(a.hasOwnProperty(c)||b.hasOwnProperty(c))&&(a[c]="object"==typeof a[c]?Object.extend(a[c],b[c]):b[c])},Object.extend=function(a,b){var c={};return Object.steal(c,a),Object.steal(c,b),c},tadpole.UI=function(a,b,c,d){this.client=b,this.options=c,this.mozilla=d,b.settings.agent="tadpole/"+tadpole.VERSION+" "+b.settings.agent,this.LIB="tadpole",this.VERSION=tadpole.VERSION,this.STATE=tadpole.STATE,a.append('<div class="tadpole"></div>'),this.view=a.find(".tadpole"),this.control=null,this.top=null,this.menu=null,this.book=null},tadpole.UI.prototype.build=function(){this.top=new tadpole.Top(this),this.book=new tadpole.Book(this),this.control=new tadpole.Control(this),this.menu=new tadpole.Menu(this)},tadpole.UI.prototype.resize=function(){},tadpole.UI.prototype.loop=function(){},tadpole.UI.prototype.toggle_menu=function(){return this.menu.toggle()},tadpole.UI.prototype.channel_add=function(a,b){var c=this.menu.channel.add(a,b);return this.book.add(a,b,c)},tadpole.Book=function(a){this.manager=a,this.clist={},this.current=null,this.build()},tadpole.Book.prototype.build=function(){this.manager.view.append('<div class="book"></div>'),this.view=this.manager.view.find("div.book")},tadpole.Book.prototype.add=function(a,b,c){var d=new tadpole.Channel(a,b,c,this.manager,this);return this.clist[a.toLowerCase()]=d,this.reveal(a),d},tadpole.Book.prototype.reveal=function(a){var b=a.toLowerCase();this.clist.hasOwnProperty(b)&&(this.current&&this.current.hide(),this.current=this.clist[b],this.current.reveal(),this.manager.top.set_label(this.current.ns))},tadpole.Channel=function(a,b,c,d,e){this.manager=d,this.book=e,this.tab=c,this.ns=a,this.raw=b,this.selector=replaceAll(this.raw,"pchat:","c-pchat-"),this.selector=replaceAll(this.selector,"chat:","c-chat-"),this.hidden=!0,this.background=!1,this.build()},tadpole.Channel.prototype.build=function(){this.book.view.append('<div class="channel" id="'+this.selector+'"><ul class="log"></ul></div>'),this.view=this.book.view.find("div.channel#"+this.selector),this.logview=this.view.find("ul.log")},tadpole.Channel.prototype.reveal=function(){this.hidden&&(this.background||(this.view.css({display:"block"}),this.hidden=!1,this.manager.top.set_label(this.ns)))},tadpole.Channel.prototype.hide=function(){this.hidden||(this.view.css({display:"none"}),this.hidden=!0)},tadpole.Channel.prototype.log=function(a){var b=new Date,c=formatTime("{HH}:{mm}:{ss}",b),d=b.getTime();return this.logview.append('<li id="'+d+'"><span class="timestamp">'+c+'</span><span class="content">'+a+"</span></li>"),this.logview.find("li#"+d)},tadpole.Channel.prototype.join=function(a){this.log('<p class="background"><strong class="event join">** '+a+" joined *</strong></p>")},tadpole.Channel.prototype.part=function(a,b){this.log('<p class="background"><strong class="event part">** '+a+" left *</strong> "+b+"</p>")},tadpole.Channel.prototype.message=function(a,b){var c=this.log('<h2 class="username">'+a+"</h2><p>"+b+"</p>");console.log(c)},tadpole.Channel.prototype.action=function(a,b){this.log('<p><em><strong class="username">* '+a+"</strong> "+b+"</em></p>")},tadpole.Channel.prototype.kick=function(a,b,c){this.log('<p><em><strong class="event kick">** '+a+" kicked by "+b+" *</strong> "+c+"</em></p>")},tadpole.ChannelMenu=function(a,b){this.manager=a,this.parentview=b,this.build()},tadpole.ChannelMenu.prototype.build=function(){this.overlay=new tadpole.Overlay(this.manager.view,"channelmenu","right"),this.overlay.view.append('<nav class="channels"><ul>  <li><span class="button" id="channelexit">&laquo; Channels</span></li></ul></nav>'),this.view=this.overlay.view.find("nav"),this.ul=this.view.find("ul"),this.button_back=this.ul.find("span#channelexit");var a=this;this.button_back.on("click",function(b){b.preventDefault(),a.hide()})},tadpole.ChannelMenu.prototype.reveal=function(){return this.overlay.reveal(),this.overlay.visible},tadpole.ChannelMenu.prototype.hide=function(){return this.overlay.hide(),this.overlay.visible},tadpole.ChannelMenu.prototype.add=function(a,b){var c=replaceAll(b,"pchat:","c-pchat-");c=replaceAll(c,"chat:","c-chat-"),this.ul.append('<li><a id="tab-'+c+'" href="#">'+a+"</a></li>");var d=this,e=this.ul.find("a#tab-"+c);return e.on("click",function(b){b.preventDefault(),d.manager.book.reveal(a),d.manager.menu.toggle()}),e},tadpole.Control=function(a){this.manager=a,this.build()},tadpole.Control.prototype.build=function(){this.manager.view.append('<div class="control"><input type="text" class="msg"></input></div>'),this.view=this.manager.view.find("div.control"),this.input=this.view.find("input"),this.input.width(this.view.width()-20)},tadpole.Menu=function(a){this.manager=a,this.build()},tadpole.Menu.prototype.build=function(){this.overlay=new tadpole.Overlay(this.manager.view,"menu"),this.overlay.view.append('<nav class="menu"><ul>  <li><a class="users" href="#">Users</a></li>  <li><a class="channels" href="#">Channels</a></li>  <li><a class="settings" href="#">Settings</a></li></ul></nav>'),this.view=this.overlay.view.find("nav"),this.button_users=this.view.find(".users"),this.button_channels=this.view.find(".channels"),this.button_settings=this.view.find(".settings");var a=this;this.button_users.on("click",function(b){b.preventDefault(),a.show_users()}),this.button_channels.on("click",function(b){b.preventDefault(),a.show_channels()}),this.button_settings.on("click",function(b){b.preventDefault(),a.show_settings()}),this.channel=new tadpole.ChannelMenu(this.manager,this.overlay.view)},tadpole.Menu.prototype.toggle=function(){return this.overlay.visible?(this.channel.hide(),this.overlay.hide(),this.manager.top.inactive(),this.overlay.visible):(this.overlay.reveal(),this.manager.top.active(),this.overlay.visible)},tadpole.Menu.prototype.hide_quick=function(){this.manager.top.inactive(),this.overlay.hide_quick()},tadpole.Menu.prototype.show_users=function(){},tadpole.Menu.prototype.show_channels=function(){this.channel.reveal()},tadpole.Menu.prototype.show_settings=function(){},tadpole.Overlay=function(a,b,c){this.parentview=a,this.cls=b,this.origin=c||"top",this.visible=!1,this.build()},tadpole.Overlay.prototype.build=function(){this.parentview.append('<div class="overlay '+this.cls+'"></div>'),this.view=this.parentview.find(".overlay."+this.cls);var a=$("body").height();this.view.height(a-95)},tadpole.Overlay.prototype.reveal=function(){if(!this.visible){switch(this.origin){case"top":default:this.view.slideDown()}this.visible=!0}},tadpole.Overlay.prototype.hide=function(){if(this.visible){switch(this.origin){case"top":default:this.view.slideUp()}this.visible=!1}},tadpole.Overlay.prototype.hide_quick=function(){this.view.css({display:"none"}),this.visible=!1},tadpole.Overlay.prototype.remove=function(){this.view.remove()},tadpole.Top=function(a){this.manager=a,this.build()},tadpole.Top.prototype.build=function(){this.manager.view.append('<div class="top"><span class="label">Tadpole</span><span class="control"><a class="menubutton" href="#">+</a></span></div>'),this.view=this.manager.view.find(".top"),this.button=this.view.find(".menubutton"),this.label=this.view.find("span.label");var a=this;this.button.on("click",function(a){a.preventDefault(),console.log("menu button clicked")}),this.view.on("click",function(b){b.preventDefault(),b.stopPropagation(),a.manager.toggle_menu()})},tadpole.Top.prototype.set_label=function(a){this.label.html(a)},tadpole.Top.prototype.active=function(){this.view.hasClass("active")||this.view.addClass("active")},tadpole.Top.prototype.inactive=function(){this.view.hasClass("active")&&this.view.removeClass("active")};